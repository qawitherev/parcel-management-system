<div class="flex h-screen">
  <!-- Sidebar -->
  <aside
    class="fixed inset-y-0 left-0 w-64 bg-[var(--clr-surface-a10)] text-[var(--clr-dark-a0)] transform transition-transform duration-300"
  >
    <div
      *ngIf="pageTitle$ | async as title"
      class="p-4 text-2xl font-bold border-b border-gray-700"
    >
      Parcel App
    </div>
    <nav class="p-4 space-y-2">
      @for (item of menuItems; track $index) { @if (item.children) {
        @if (userRole$ | async; as role) {
          @if (item.roles?.includes(role.role)) {
        <a
          (click)="toggleParentExpand(item.label)"
          class="block py-2 px-3 rounded hover:bg-[var(--clr-surface-a50)] cursor-pointer font-semibold text-[var(--clr-dark-a0)]"
        >
          {{ item.label }}
        </a>
        }
        }
        


      @if (isExpanded(item.label)) {
      <div class="ml-4 space-y-1">
        @for (child of item.children; track $index) {
        <div *ngIf="userRole$ | async as role">
          @if ((child.roles?.includes(role.role))) {
          <a class="block py-2 px-3 rounded hover:bg-[var(--clr-surface-a50)]" [routerLink]="child.route">
            {{ child.label }}
          </a>
          }
        </div>
        }
      </div>
      } } @else {
      <a
        class="block py-2 px-3 rounded hover:bg-[var(--clr-surface-a50)] font-semibold text-[var(--clr-dark-a0)]"
        [routerLink]="item.route"
      >
        {{ item.label }}
      </a>
      } }
    </nav>
  </aside>

  <!-- Main content -->
  <div class="flex-1 flex flex-col ml-0 lg:ml-64 transition-all duration-300">
    <!-- Topbar -->
    <header class="bg-[var(--clr-surface-a0)] shadow p-4 flex justify-between items-center">
      <!-- Hamburger -->
      <h1 *ngIf="pageTitle$ | async as title" class="text-lg text-[var(--clr-dark-a0)] font-semibold">{{ title }}</h1>
      
      <div class="flex gap-3">
        <app-my-switch
        class="flex"
        labelOn="Dark Mode"
        labelOff="Dark Mode"
        [isPositive]="isDarkMode"
        (toggled)="onThemeToggle()"
            ></app-my-switch>
        
        <app-my-button
          variant="danger"
          label="Logout"
          type="button"
          (clicked)="logout()"
        ></app-my-button>
      </div>
    </header>

    <!-- Page Content -->
    <main class="p-6 flex-1 overflow-y-auto bg-[var(--clr-surface-a0)]">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>
